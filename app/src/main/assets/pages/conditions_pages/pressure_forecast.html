<!DOCTYPE html>
<html lang="en" Theme="clothing" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <title>Pressure Forecast</title>
    <link rel="stylesheet" href="../../ui-files/font-usage.css">
    <link rel="stylesheet" href="../../ui-files/variables.css">
    <link rel="stylesheet" href="../../components/components.css">
    <link rel="stylesheet" href="../../ripple-files/ripple.css">
    <link rel="stylesheet" href="../../components/modal-ver.css">
    <link rel="stylesheet" href="condition_pageUI.css">
    <script src="../../langs/langs.js"></script>

    <style>
        .condition_info_content::before {
            position: fixed;
            bottom: 0;
            content: '';
            width: 100%;
            background: linear-gradient(0deg, var(--Surface) 10%, rgba(255, 0, 0, 0));
            height: 30px;
            z-index: 1;
        }
    </style>
</head>

<body>
    <div class="top_conditions_for_header">
        <md-icon-button onclick="sendThemeToAndroid('GoBack')">
            <md-icon icon-outlined>arrow_back</md-icon>
        </md-icon-button>
    </div>

    <div class="condition_info_content">
        <div class="condition_label_forecast">
            <md-icon icon-outlined>compress</md-icon>
            <p data-translate="pressure">Pressure</p>
        </div>

        <div class="pressureCard">
            
            <div>
                <span data-translate="current_conditions">Current condition</span>
                <div>
                    <p id="pressureValue">30.09</p>
                    <p id="pressureUnit">inHg</p>
                </div>
            </div>

            <md-linear-progress value="0" id="pressureBar"></md-linear-progress>
        </div>

        <div class="info__forecast">

            <span data-translate="pressure_info">Atmospheric pressure, also known as air pressure or baromatic pressure, is the downward pressure exerted by the earth's atmosphere. This app uses Mean Sea Level Pressure (MSLP).</span>

            <span data-translate="pressure_info_2">Abnormal atmospheric pressure may cause headaches, joint pain, fatigue, and other effects.</span>

        </div>

    </div>



    <script>
    function hexToRgb(hex) {
    const bigint = parseInt(hex.slice(1), 16);
    return {
        r: (bigint >> 16) & 255,
        g: (bigint >> 8) & 255,
        b: bigint & 255
    };
}

function rgbToHsl({ r, g, b }) {
    r /= 255;
    g /= 255;
    b /= 255;

    const max = Math.max(r, g, b);
    const min = Math.min(r, g, b);
    let h, s, l = (max + min) / 2;

    if (max === min) {
        h = s = 0; // Achromatic
    } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
    }

    return { h: h * 360, s: s * 100, l: l * 100 };
}

function CreateMaterialYouTheme(hex) {
    const colors = {
        orange_material: "#FFA500",
        red_material: "#FF0000",
        pink_material: "#FFC0CB",
        purple_material: "#800080",
        blue_material: "#0000FF",
        yellow_material: "#FFFF00",
        green_material: "#008000"
    };

    const targetHsl = rgbToHsl(hexToRgb(hex));
    let closestColor = null;
    let smallestHueDifference = Infinity;

    for (const [color, colorHex] of Object.entries(colors)) {
        const colorHsl = rgbToHsl(hexToRgb(colorHex));
        const hueDifference = Math.abs(targetHsl.h - colorHsl.h);

        if (hueDifference < smallestHueDifference) {
            smallestHueDifference = hueDifference;
            closestColor = color;
        }
    }

    document.documentElement.setAttribute('Theme', closestColor);
    sendThemeToAndroid(`${closestColor}_ScrollFalse`);
}
        const cachedCurrentDataAvg = JSON.parse(localStorage.getItem('CurrentHourlyCache'));
        const SelectedPressureUnit = localStorage.getItem('selectedPressureUnit');
        const pressureBar = document.getElementById('pressureBar');

        function getpressure(data) {


                let pressureMain;
                let pressureMainUnit;

                if (SelectedPressureUnit === 'inHg') {
                    pressureMain = (data * 0.02953).toFixed(2);
                    pressureMainUnit = 'inHg';
                } else if (SelectedPressureUnit === 'mmHg') {
                    pressureMain = (data * 0.750062).toFixed(2);
                    pressureMainUnit = 'mmHg';
                } else {
                    pressureMain = data;
                    pressureMainUnit = 'hPa';
                }

                const pressureBarValue = Math.round(data);



            if (pressureBarValue <= 1000) {
                pressureBar.value = '0.2';
            } else if (pressureBarValue > 1000 && pressureBarValue <= 1010) {
                pressureBar.value = '0.4';
            } else if (pressureBarValue > 1010 && pressureBarValue <= 1020) {
                pressureBar.value = '0.5';
            } else if (pressureBarValue > 1020 && pressureBarValue <= 1030) {
                pressureBar.value = '0.7';
            } else if (pressureBarValue > 1030) {
                pressureBar.value = '1';
            }




                document.getElementById('pressureValue').innerHTML = pressureMain
                document.getElementById('pressureUnit').innerHTML = pressureMainUnit

        }


        getpressure(localStorage.getItem('CurrentPressurePage'))


  function sendThemeToAndroid(theme) {

AndroidInterface.updateStatusBarColor(theme);
};
    </script>

    <script src="../../app/navigate.js"></script>
    <script src="../../components-script.js/components.js"></script>
    <script src="../../ripple-files/icon-ripple.js"></script>
    <script src="../../modules/scroll.js"></script>
    <script src="../../bundle.js"></script>
    <script type="module" src="../../index.js"></script>
    <script src="../../modules/ripple_acc.js"></script>
</body>

</html>